<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Admin - Tech-Ponto</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚è∞</text></svg>">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/justificativas.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body class="dashboard">
    <header class="header">
        <div class="header-content">
            <div class="header-logo">
                <i class="fas fa-user-cog"></i>
                <h2>Tech-Ponto Admin</h2>
            </div>
            
            <div class="user-info">
                <span class="user-name" id="userName">Administrador</span>
                <span class="user-type">admin</span>
                <button class="btn-verify-session" onclick="verificarSessaoInteligente(true)" title="Verificar Sess√£o">
                    <i class="fas fa-shield-alt"></i>
                </button>
                <button class="btn-logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    Sair
                </button>
            </div>
        </div>
    </header>

    <nav class="admin-nav">
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('usuarios')">
                <i class="fas fa-users"></i>
                Usu√°rios
            </button>
            <button class="nav-tab" onclick="switchTab('departamentos')">
                <i class="fas fa-building"></i>
                Departamentos
            </button>
            <button class="nav-tab" onclick="switchTab('jornadas')">
                <i class="fas fa-clock"></i>
                Jornadas
            </button>
            <button class="nav-tab" onclick="switchTab('registros')">
                <i class="fas fa-edit"></i>
                Registros de Ponto
            </button>
            <button class="nav-tab" onclick="switchTab('justificativas')">
                <i class="fas fa-clipboard-check"></i>
                Justificativas
            </button>
            <button class="nav-tab" onclick="switchTab('relatorios')">
                <i class="fas fa-chart-bar"></i>
                Relat√≥rios
            </button>
            <button class="nav-tab" onclick="switchTab('configuracoes')">
                <i class="fas fa-cog"></i>
                Configura√ß√µes
            </button>
            <button class="nav-tab" onclick="switchTab('compliance')">
                <i class="fas fa-file-contract"></i>
                Conformidade MTP 671/2021
            </button>
            <button class="nav-tab" onclick="switchTab('atualizacoes')">
                <i class="fas fa-sync-alt"></i>
                Atualiza√ß√µes
            </button>
        </div>
    </nav>

    <main class="main-content">
        <!-- Aba Usu√°rios -->
        <div id="usuarios-tab" class="tab-content active">
            <section class="admin-section">
                <div class="section-header">
                    <h3>Gerenciar Usu√°rios</h3>
                    <button class="btn-primary" onclick="abrirModalUsuario()">
                        <i class="fas fa-plus"></i>
                        Novo Usu√°rio
                    </button>
                </div>
                
                <div class="history-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>CPF</th>
                                <th>Matr√≠cula</th>
                                <th>Cargo</th>
                                <th>Login</th>
                                <th>Tipo</th>
                                <th>Departamento</th>
                                <th>Grupo Jornada</th>
                                <th>Carga Di√°ria</th>
                                <th>Toler√¢ncia</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="usuariosTableBody">
                            <tr>
                                <td colspan="12" style="text-align: center; padding: 40px;">
                                    Carregando usu√°rios...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- Aba Departamentos -->
        <div id="departamentos-tab" class="tab-content">
            <section class="admin-section">
                <div class="section-header">
                    <h3>Gerenciar Departamentos</h3>
                    <button class="btn-primary" onclick="abrirModalDepartamento()">
                        <i class="fas fa-plus"></i>
                        Novo Departamento
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>C√≥digo</th>
                                <th>Descri√ß√£o</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="departamentosTableBody">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 40px;">
                                    Carregando departamentos...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- Aba Jornadas -->
        <div id="jornadas-tab" class="tab-content">
            <section class="admin-section">
                <div class="section-header">
                    <h3>Gerenciar Grupos de Jornada</h3>
                    <button class="btn-primary" onclick="abrirModalJornada()">
                        <i class="fas fa-plus"></i>
                        Nova Jornada
                    </button>
                </div>
                
                <div class="table-container">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>C√≥digo</th>
                                <th>Entrada</th>
                                <th>Almo√ßo</th>
                                <th>Retorno</th>
                                <th>Sa√≠da</th>
                                <th>Carga</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="jornadasTableBody">
                            <tr>
                                <td colspan="10" style="text-align: center; padding: 40px;">
                                    Carregando jornadas...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- Aba Registros de Ponto -->
        <div id="registros-tab" class="tab-content">
            <div class="registros-container">
                <div class="registros-header">
                    <h3>
                        <i class="fas fa-clock header-icon"></i>
                        Gerenciar Registros de Ponto
                    </h3>
                    <button class="btn-primary" onclick="abrirModalInserirRegistro()">
                        <i class="fas fa-plus"></i>
                        Inserir Registro
                    </button>
                </div>
                
                <!-- Filtros -->
                <div class="filters-container" style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; align-items: end;">
                    <div class="form-group" style="flex: 1; min-width: 200px;">
                        <label for="filtroFuncionario">Funcion√°rio:</label>
                        <select id="filtroFuncionario" style="width: 100%; padding: 8px;">
                            <option value="">Todos os funcion√°rios</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="flex: 0 0 150px;">
                        <label for="filtroDataInicio">Data In√≠cio:</label>
                        <input type="date" id="filtroDataInicio" style="width: 100%; padding: 8px;">
                    </div>
                    
                    <div class="form-group" style="flex: 0 0 150px;">
                        <label for="filtroDataFim">Data Fim:</label>
                        <input type="date" id="filtroDataFim" style="width: 100%; padding: 8px;">
                    </div>
                    
                    <div class="form-group" style="flex: 0 0 120px;">
                        <label>
                            <input type="checkbox" id="filtroApenasEditados">
                            Apenas editados
                        </label>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-filter" onclick="buscarRegistrosPonto()" style="height: fit-content;">
                            <i class="fas fa-search"></i>
                            Buscar
                        </button>
                        <button class="btn-secondary" onclick="limparFiltrosRegistros()" style="height: fit-content;">
                            <i class="fas fa-times"></i>
                            Limpar
                        </button>
                    </div>
                </div>
                
                <!-- Cards de Estat√≠sticas -->
                <div class="stats-grid" id="statsGrid" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-number" id="totalRegistros">0</div>
                        <div class="stat-label">Total de Registros</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-number" id="registrosCompletos">0</div>
                        <div class="stat-label">Registros Completos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚ö†Ô∏è</div>
                        <div class="stat-number" id="registrosIncompletos">0</div>
                        <div class="stat-label">Registros Incompletos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úèÔ∏è</div>
                        <div class="stat-number" id="registrosEditados">0</div>
                        <div class="stat-label">Registros Editados</div>
                    </div>
                </div>
                
                <!-- Tabela de Registros -->
                <div class="table-container">
                    <table class="registros-table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-user"></i> Funcion√°rio</th>
                                <th><i class="fas fa-calendar"></i> Data</th>
                                <th class="ponto-cell"><i class="fas fa-sign-in-alt"></i> Entrada</th>
                                <th class="ponto-cell"><i class="fas fa-utensils"></i> Sa√≠da Almo√ßo</th>
                                <th class="ponto-cell"><i class="fas fa-undo"></i> Volta Almo√ßo</th>
                                <th class="ponto-cell"><i class="fas fa-sign-out-alt"></i> Sa√≠da</th>
                                <th><i class="fas fa-info-circle"></i> Status</th>
                                <th><i class="fas fa-cog"></i> AJUSTE</th>
                                <th><i class="fas fa-info-circle"></i> Detalhes do Ajuste</th>
                                <th><i class="fas fa-cogs"></i> A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="registrosPontoTableBody">
                            <tr>
                                <td colspan="10" style="text-align: center; padding: 40px; color: var(--gray-500);">
                                    <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 16px; display: block;"></i>
                                    <strong>Selecione um funcion√°rio e per√≠odo para visualizar os registros</strong>
                                    <br><small>Use os filtros acima para come√ßar</small>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Aba Justificativas -->
        <div id="justificativas-tab" class="tab-content">
            <div class="justificativas-container">
                <div class="justificativas-header">
                    <h3>
                        <i class="fas fa-clipboard-check header-icon"></i>
                        Gerenciar Justificativas
                    </h3>
                    <button class="btn-primary" onclick="abrirModalNovaJustificativa()">
                        <i class="fas fa-plus"></i>
                        Nova Justificativa
                    </button>
                </div>
                
                <!-- Filtros -->
                <div class="filters-container" style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; align-items: end;">
                    <div class="form-group" style="flex: 1; min-width: 200px;">
                        <label for="filtroFuncionarioJust">Funcion√°rio:</label>
                        <select id="filtroFuncionarioJust" style="width: 100%; padding: 8px;">
                            <option value="">Todos os funcion√°rios</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="flex: 0 0 150px;">
                        <label for="filtroDataInicioJust">Data In√≠cio:</label>
                        <input type="date" id="filtroDataInicioJust" style="width: 100%; padding: 8px;">
                    </div>
                    
                    <div class="form-group" style="flex: 0 0 150px;">
                        <label for="filtroDataFimJust">Data Fim:</label>
                        <input type="date" id="filtroDataFimJust" style="width: 100%; padding: 8px;">
                    </div>
                    
                    <div class="form-group" style="flex: 0 0 150px;">
                        <label for="filtroTipoJust">Tipo:</label>
                        <select id="filtroTipoJust" style="width: 100%; padding: 8px;">
                            <option value="">Todos os tipos</option>
                        </select>
                    </div>
                    
                    <div class="form-group" style="flex: 0 0 120px;">
                        <label for="filtroStatusJust">Status:</label>
                        <select id="filtroStatusJust" style="width: 100%; padding: 8px;">
                            <option value="">Todos</option>
                            <option value="ativa">Ativa</option>
                            <option value="cancelada">Cancelada</option>
                            <option value="expirada">Expirada</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-filter" onclick="buscarJustificativas()" style="height: fit-content;">
                            <i class="fas fa-search"></i>
                            Buscar
                        </button>
                        <button class="btn-secondary" onclick="limparFiltrosJustificativas()" style="height: fit-content;">
                            <i class="fas fa-times"></i>
                            Limpar
                        </button>
                    </div>
                </div>
                
                <!-- Cards de Estat√≠sticas -->
                <div class="stats-grid" id="statsJustificativas" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clipboard-check"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalJustificativas">0</div>
                            <div class="stat-label">Total</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="justificativasAtivas">0</div>
                            <div class="stat-label">Ativas</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-umbrella-beach"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalFerias">0</div>
                            <div class="stat-label">F√©rias</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-md"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalAtestados">0</div>
                            <div class="stat-label">Atestados</div>
                        </div>
                    </div>
                </div>
                
                <!-- Tabela de Justificativas -->
                <div class="table-container">
                    <table class="data-table" id="justificativasTable">
                        <thead>
                            <tr>
                                <th>Funcion√°rio</th>
                                <th>Tipo</th>
                                <th>Data In√≠cio</th>
                                <th>Data Fim</th>
                                <th>Per√≠odo</th>
                                <th>Status</th>
                                <th>Criado em</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="justificativasTableBody">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 40px;">
                                    Selecione os filtros e clique em "Buscar" para visualizar as justificativas
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Pagina√ß√£o -->
                <div class="pagination" id="paginationJustificativas" style="display: none;">
                    <button class="btn-pagination" onclick="paginarJustificativas('prev')" disabled>
                        <i class="fas fa-chevron-left"></i>
                        Anterior
                    </button>
                    <span class="pagination-info" id="paginationInfoJustificativas"></span>
                    <button class="btn-pagination" onclick="paginarJustificativas('next')" disabled>
                        Pr√≥ximo
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Aba Relat√≥rios -->
        <div id="relatorios-tab" class="tab-content">
            <section class="admin-section">
                <div class="section-header">
                    <h3>
                        <i class="fas fa-id-card"></i>
                        Cart√£o de Ponto
                    </h3>
                    <button class="btn-primary" onclick="gerarCartaoPonto()">
                        <i class="fas fa-print"></i>
                        Gerar Cart√£o de Ponto
                    </button>
                </div>
                
                <div class="info-box" style="background: #eff6ff; border: 1px solid #3b82f6; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                    <p style="margin: 0; color: #1e40af;">
                        <i class="fas fa-info-circle"></i>
                        <strong>Cart√£o de Ponto Oficial:</strong> Documento profissional para controle de frequ√™ncia, pronto para impress√£o e assinatura.
                    </p>
                </div>
                
                <div style="display: flex; gap: 20px; margin-bottom: 20px; flex-wrap: wrap;">
                    <div class="form-group" style="flex: 1; min-width: 200px;">
                        <label>
                            <i class="fas fa-calendar-day"></i>
                            Data In√≠cio:
                        </label>
                        <input type="date" id="relDataInicio" style="width: 100%; padding: 8px;" onchange="sugerirPeriodoMensal()">
                    </div>
                    
                    <div class="form-group" style="flex: 1; min-width: 200px;">
                        <label>
                            <i class="fas fa-calendar-day"></i>
                            Data Fim:
                        </label>
                        <input type="date" id="relDataFim" style="width: 100%; padding: 8px;" onchange="sugerirPeriodoMensal()">
                    </div>
                    
                    <div class="form-group" style="flex: 1; min-width: 200px;">
                        <label>
                            <i class="fas fa-user"></i>
                            Funcion√°rio: <span style="color: #dc2626;">*</span>
                        </label>
                        <select id="relUsuario" style="width: 100%; padding: 8px;" required>
                            <option value="">Selecione um funcion√°rio</option>
                        </select>
                    </div>
                </div>
                
                <div style="background: #fef3c7; border: 1px solid #f59e0b; border-radius: 8px; padding: 12px; margin-bottom: 20px;">
                    <p style="margin: 0; color: #92400e; font-size: 0.9rem;">
                        <i class="fas fa-lightbulb"></i>
                        <strong>Dica:</strong> Para relat√≥rio mensal completo, selecione do dia 01 at√© o √∫ltimo dia do m√™s.
                    </p>
                </div>
                
                <div style="text-align: center; padding: 60px 20px; background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <div style="max-width: 500px; margin: 0 auto;">
                        <i class="fas fa-id-card" style="font-size: 80px; color: #3b82f6; margin-bottom: 20px;"></i>
                        <h3 style="color: #1e293b; margin-bottom: 10px;">Cart√£o de Ponto</h3>
                        <p style="color: #64748b; margin-bottom: 30px; line-height: 1.6;">
                            Selecione o funcion√°rio e per√≠odo desejado, depois clique no bot√£o acima para gerar o cart√£o de ponto profissional.
                        </p>
                        
                        <div style="background: #f8fafc; border-radius: 8px; padding: 20px; margin-top: 20px; text-align: left;">
                            <h4 style="color: #1e293b; margin-bottom: 12px; font-size: 0.9rem;">
                                <i class="fas fa-check-circle" style="color: #10b981;"></i>
                                O Cart√£o de Ponto Inclui:
                            </h4>
                            <ul style="color: #475569; font-size: 0.85rem; line-height: 1.8; margin: 0; padding-left: 20px;">
                                <li>‚úÖ Dados completos do funcion√°rio e da empresa</li>
                                <li>‚úÖ Registro di√°rio de todos os hor√°rios batidos</li>
                                <li>‚úÖ C√°lculo autom√°tico de horas trabalhadas</li>
                                <li>‚úÖ Totalizadores de extras e faltas</li>
                                <li>‚úÖ Campos de assinatura (funcion√°rio e RH)</li>
                                <li>‚úÖ Pronto para impress√£o e arquivamento</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Aba Configura√ß√µes -->
        <div id="configuracoes-tab" class="tab-content">
            <style>
                #configuracoes-tab * {
                    visibility: visible !important;
                    opacity: 1 !important;
                }
                #configuracoes-tab .admin-section {
                    display: block !important;
                    min-height: 600px !important;
                    background: white !important;
                    padding: 30px !important;
                    border-radius: 12px !important;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important;
                    margin-bottom: 20px !important;
                }
                #configuracoes-tab .config-form-container {
                    display: block !important;
                    background: white !important;
                    border-radius: 12px !important;
                    padding: 2rem !important;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important;
                    margin-bottom: 2rem !important;
                }
                #configuracoes-tab .config-form {
                    display: block !important;
                    max-width: 100% !important;
                }
                #configuracoes-tab .config-grid {
                    display: grid !important;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
                    gap: 1.5rem !important;
                    margin-bottom: 2rem !important;
                }
                #configuracoes-tab .config-group {
                    display: flex !important;
                    flex-direction: column !important;
                }
                #configuracoes-tab .config-group label {
                    display: flex !important;
                    align-items: center !important;
                    gap: 0.5rem !important;
                    font-weight: 600 !important;
                    color: #374151 !important;
                    margin-bottom: 0.5rem !important;
                    font-size: 0.9rem !important;
                }
                #configuracoes-tab .config-group input {
                    display: block !important;
                    padding: 0.75rem !important;
                    border: 2px solid #d1d5db !important;
                    border-radius: 8px !important;
                    font-size: 0.9rem !important;
                    background: white !important;
                    color: #374151 !important;
                }
                #configuracoes-tab .config-group small {
                    display: block !important;
                    color: #6b7280 !important;
                    font-size: 0.8rem !important;
                    margin-top: 0.25rem !important;
                }
                #configuracoes-tab .config-actions {
                    display: flex !important;
                    gap: 1rem !important;
                    justify-content: flex-end !important;
                    padding-top: 1.5rem !important;
                    border-top: 1px solid #e5e7eb !important;
                }
                #configuracoes-tab .config-preview {
                    display: block !important;
                    background: white !important;
                    border-radius: 12px !important;
                    padding: 2rem !important;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important;
                }
            </style>
            <section class="admin-section">
                <div class="section-header">
                    <h3>Configura√ß√µes da Empresa</h3>
                    <p>Configure as informa√ß√µes da empresa que aparecem nos relat√≥rios e cart√µes de ponto</p>
                </div>
                
                <div class="config-form-container">
                    <form id="configEmpresaForm" class="config-form">
                        <div class="config-grid">
                            <div class="config-group">
                                <label for="empresa_nome">
                                    <i class="fas fa-building"></i>
                                    Nome da Empresa
                                </label>
                                <input type="text" id="empresa_nome" name="empresa_nome" placeholder="Digite o nome da empresa" required>
                                <small>Nome que aparece no cabe√ßalho dos relat√≥rios</small>
                            </div>
                            
                            <div class="config-group">
                                <label for="empresa_cnpj">
                                    <i class="fas fa-id-card"></i>
                                    CNPJ
                                </label>
                                <input type="text" id="empresa_cnpj" name="empresa_cnpj" placeholder="00.000.000/0001-00" maxlength="18">
                                <small>CNPJ da empresa (formato: 00.000.000/0001-00)</small>
                            </div>
                            
                            <div class="config-group full-width">
                                <label for="empresa_endereco">
                                    <i class="fas fa-map-marker-alt"></i>
                                    Endere√ßo Completo
                                </label>
                                <input type="text" id="empresa_endereco" name="empresa_endereco" placeholder="Rua, n√∫mero, bairro" required>
                                <small>Endere√ßo completo da empresa</small>
                            </div>
                            
                            <div class="config-group">
                                <label for="empresa_cidade">
                                    <i class="fas fa-city"></i>
                                    Cidade/Estado
                                </label>
                                <input type="text" id="empresa_cidade" name="empresa_cidade" placeholder="S√£o Paulo - SP" required>
                                <small>Cidade e estado da empresa</small>
                            </div>
                            
                            <div class="config-group">
                                <label for="empresa_telefone">
                                    <i class="fas fa-phone"></i>
                                    Telefone
                                </label>
                                <input type="text" id="empresa_telefone" name="empresa_telefone" placeholder="(11) 1234-5678" maxlength="15">
                                <small>Telefone de contato da empresa</small>
                            </div>
                            
                            <div class="config-group">
                                <label for="empresa_email">
                                    <i class="fas fa-envelope"></i>
                                    E-mail
                                </label>
                                <input type="email" id="empresa_email" name="empresa_email" placeholder="contato@empresa.com">
                                <small>E-mail de contato da empresa</small>
                            </div>
                            
                            
                            <div class="config-group">
                                <label for="empresa_logo">
                                    <i class="fas fa-image"></i>
                                    Logo da Empresa
                                </label>
                                <input type="file" id="empresa_logo" name="empresa_logo" accept="image/*" onchange="previewLogo(this)">
                                <small>Selecione uma imagem do seu computador (JPG, PNG, GIF)</small>
                                <div id="logo-preview" style="margin-top: 10px; display: none;">
                                    <img id="preview-image" style="max-width: 200px; max-height: 100px; border: 1px solid #ddd;">
                                </div>
                            </div>
                        </div>
                        
                        <div class="config-actions">
                            <button type="button" class="btn btn-secondary" onclick="carregarConfiguracoes()">
                                <i class="fas fa-undo"></i>
                                Recarregar
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i>
                                Salvar Configura√ß√µes
                            </button>
                        </div>
                    </form>
                </div>
                
                <div class="config-preview">
                    <h4>Preview do Cabe√ßalho</h4>
                    <div class="preview-card">
                        <div class="preview-header">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                                <img id="preview-logo" src="" style="max-height: 60px; max-width: 120px; display: none;">
                                <h3 id="preview-nome">Nome da Empresa</h3>
                            </div>
                            <p class="preview-document-title">CART√ÉO DE PONTO - CONTROLE DE FREQU√äNCIA</p>
                            <div class="preview-info">
                                <p><strong>CNPJ:</strong> <span id="preview-cnpj">00.000.000/0001-00</span></p>
                                <p><strong>Endere√ßo:</strong> <span id="preview-endereco">Rua da Empresa, 123</span></p>
                                <p><strong>Cidade:</strong> <span id="preview-cidade">S√£o Paulo - SP</span></p>
                                <p><strong>Telefone:</strong> <span id="preview-telefone">(11) 1234-5678</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Aba Conformidade MTP 671/2021 -->
        <div id="compliance-tab" class="tab-content">
            <section class="admin-section">
                <div class="section-header">
                    <h3>
                        <i class="fas fa-file-contract"></i>
                        Conformidade com Portaria MTP 671/2021
                    </h3>
                    <p>Gera√ß√£o de documentos obrigat√≥rios para o DET (Departamento de Emprego e Trabalho)</p>
                </div>
                
                <!-- Cards de Funcionalidades -->
                <div class="compliance-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    
                    <!-- AFD -->
                    <div class="compliance-card">
                        <div class="card-header">
                            <i class="fas fa-file-alt"></i>
                            <h4>AFD - Arquivo Fonte de Dados</h4>
                        </div>
                        <div class="card-content">
                            <p>Exporta registros brutos de ponto no formato exigido pela portaria.</p>
                            <button class="btn-primary" onclick="abrirModalAFD()">
                                <i class="fas fa-download"></i>
                                Gerar AFD
                            </button>
                        </div>
                    </div>
                    
                    <!-- AEJ -->
                    <div class="compliance-card">
                        <div class="card-header">
                            <i class="fas fa-clock"></i>
                            <h4>AEJ - Arquivo Eletr√¥nico de Jornada</h4>
                        </div>
                        <div class="card-content">
                            <p>Gera jornada efetiva trabalhada a partir dos batimentos e escalas.</p>
                            <button class="btn-primary" onclick="abrirModalAEJ()">
                                <i class="fas fa-download"></i>
                                Gerar AEJ
                            </button>
                        </div>
                    </div>
                    
                    <!-- Atestado PTRP -->
                    <div class="compliance-card">
                        <div class="card-header">
                            <i class="fas fa-certificate"></i>
                            <h4>Atestado T√©cnico PTRP</h4>
                        </div>
                        <div class="card-content">
                            <p>Atestado t√©cnico do Programa de Tratamento de Registros de Ponto.</p>
                            <button class="btn-primary" onclick="gerarAtestadoPTRP()">
                                <i class="fas fa-file-pdf"></i>
                                Gerar PDF
                            </button>
                        </div>
                    </div>
                    
                    <!-- Atestado REPs -->
                    <div class="compliance-card">
                        <div class="card-header">
                            <i class="fas fa-mobile-alt"></i>
                            <h4>Atestado T√©cnico REPs</h4>
                        </div>
                        <div class="card-content">
                            <p>Atestado t√©cnico dos Reposit√≥rios Eletr√¥nicos de Ponto.</p>
                            <button class="btn-primary" onclick="gerarAtestadoREPs()">
                                <i class="fas fa-file-pdf"></i>
                                Gerar PDF
                            </button>
                        </div>
                    </div>
                    
                    <!-- Espelho Eletr√¥nico -->
                    <div class="compliance-card">
                        <div class="card-header">
                            <i class="fas fa-mirror"></i>
                            <h4>Espelho Eletr√¥nico (Art. 84)</h4>
                        </div>
                        <div class="card-content">
                            <p>Relat√≥rio com identifica√ß√£o, batidas, totais de horas, extras e faltas.</p>
                            <button class="btn-primary" onclick="abrirModalEspelho()">
                                <i class="fas fa-file-pdf"></i>
                                Gerar Espelho
                            </button>
                        </div>
                    </div>
                    
                    <!-- Compacta√ß√£o ZIP -->
                    <div class="compliance-card">
                        <div class="card-header">
                            <i class="fas fa-file-archive"></i>
                            <h4>Compacta√ß√£o para DET</h4>
                        </div>
                        <div class="card-content">
                            <p>Compacta m√∫ltiplos arquivos em ZIP para envio via DET.</p>
                            <button class="btn-primary" onclick="abrirModalCompactacao()">
                                <i class="fas fa-compress"></i>
                                Compactar Arquivos
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Hist√≥rico de Gera√ß√µes -->
                <div class="compliance-history">
                    <h4>Hist√≥rico de Gera√ß√µes</h4>
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>Data/Hora</th>
                                    <th>Tipo</th>
                                    <th>Per√≠odo</th>
                                    <th>Funcion√°rio</th>
                                    <th>Arquivo</th>
                                    <th>Status</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody id="complianceHistoryTableBody">
                                <tr>
                                    <td colspan="7" style="text-align: center; padding: 40px;">
                                        Nenhum arquivo gerado ainda
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>

        <!-- Aba Atualiza√ß√µes -->
        <div id="atualizacoes-tab" class="tab-content">
            <section class="admin-section">
                <div class="section-header">
                    <h3>
                        <i class="fas fa-sync-alt"></i>
                        Sistema de Atualiza√ß√µes
                    </h3>
                    <p>Gerencie atualiza√ß√µes do sistema de forma segura e autom√°tica</p>
                </div>
                
                <!-- Status do Sistema -->
                <div class="update-status-card" style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <div class="status-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="margin: 0; color: #495057;">
                            <i class="fas fa-info-circle"></i>
                            Status do Sistema
                        </h4>
                        <button class="btn btn-sm btn-outline-primary" onclick="atualizarStatusSistema()">
                            <i class="fas fa-refresh"></i>
                            Atualizar
                        </button>
                    </div>
                    
                    <div id="sistema-status" class="status-info">
                        <div class="status-item">
                            <strong>Vers√£o Atual:</strong> <span id="versao-atual">Carregando...</span>
                        </div>
                        <div class="status-item">
                            <strong>√öltima Verifica√ß√£o:</strong> <span id="ultima-verificacao">Nunca</span>
                        </div>
                        <div class="status-item">
                            <strong>Status:</strong> <span id="status-sistema" class="badge badge-success">Atualizado</span>
                        </div>
                    </div>
                </div>
                
                <!-- Controles de Atualiza√ß√£o -->
                <div class="update-controls" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    
                    <!-- Verificar Atualiza√ß√µes -->
                    <div class="control-card" style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                        <div class="card-header" style="margin-bottom: 15px;">
                            <i class="fas fa-search" style="color: #007bff; margin-right: 10px;"></i>
                            <h4 style="margin: 0;">Verificar Atualiza√ß√µes</h4>
                        </div>
                        <div class="card-content">
                            <p style="color: #6c757d; margin-bottom: 15px;">Verifica se h√° novas vers√µes dispon√≠veis no GitHub.</p>
                            <button class="btn btn-primary" onclick="verificarAtualizacoes()" id="btn-verificar">
                                <i class="fas fa-search"></i>
                                Verificar Agora
                            </button>
                        </div>
                    </div>
                    
                    <!-- Gerenciar Backups -->
                    <div class="control-card" style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                        <div class="card-header" style="margin-bottom: 15px;">
                            <i class="fas fa-database" style="color: #28a745; margin-right: 10px;"></i>
                            <h4 style="margin: 0;">Gerenciar Backups</h4>
                        </div>
                        <div class="card-content">
                            <p style="color: #6c757d; margin-bottom: 15px;">Visualize e gerencie backups do sistema.</p>
                            <button class="btn btn-success" onclick="abrirModalBackups()">
                                <i class="fas fa-database"></i>
                                Ver Backups
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Resultado da Verifica√ß√£o -->
                <div id="update-result" class="update-result" style="display: none; margin-bottom: 20px;">
                    <!-- Conte√∫do ser√° preenchido dinamicamente -->
                </div>
                
                <!-- Informa√ß√µes da Atualiza√ß√£o -->
                <div id="update-details" class="update-details" style="display: none; background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px;">
                        <i class="fas fa-info-circle"></i>
                        Detalhes da Atualiza√ß√£o
                    </h4>
                    <div id="update-info-content">
                        <!-- Conte√∫do ser√° preenchido dinamicamente -->
                    </div>
                </div>
                
                <!-- Logs de Atualiza√ß√£o -->
                <div class="update-logs" style="background: white; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">
                    <div class="logs-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="margin: 0;">
                            <i class="fas fa-list-alt"></i>
                            Logs de Atualiza√ß√£o
                        </h4>
                        <button class="btn btn-sm btn-outline-secondary" onclick="carregarLogsAtualizacao()">
                            <i class="fas fa-refresh"></i>
                            Atualizar
                        </button>
                    </div>
                    
                    <div id="logs-content" class="logs-content" style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 15px; max-height: 300px; overflow-y: auto; font-family: monospace; font-size: 12px;">
                        <div class="log-entry" style="color: #6c757d; text-align: center; padding: 20px;">
                            <i class="fas fa-info-circle"></i>
                            Clique em "Atualizar" para carregar os logs
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Modal Usu√°rio -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="modalTitle">Novo Usu√°rio</h4>
                <button class="btn-close" onclick="fecharModal()">&times;</button>
            </div>
            
            <form class="modal-form" id="userForm">
                <input type="hidden" id="userId">
                
                <div class="form-group">
                    <label for="userName">Nome Completo:</label>
                    <input type="text" id="userNameInput" required>
                </div>
                
                <div class="form-group">
                    <label for="userCpf">CPF:</label>
                    <input type="text" id="userCpf" placeholder="000.000.000-00" maxlength="14">
                    <small style="color: #6b7280; font-size: 0.8rem;">
                        CPF do funcion√°rio (opcional)
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="userMatricula">Matr√≠cula:</label>
                    <input type="text" id="userMatricula" placeholder="Ex: 001, 12345">
                    <small style="color: #6b7280; font-size: 0.8rem;">
                        Matr√≠cula do funcion√°rio (opcional)
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="userCargo">Cargo:</label>
                    <input type="text" id="userCargo" placeholder="Ex: Auxiliar, Gerente, Analista">
                    <small style="color: #6b7280; font-size: 0.8rem;">
                        Cargo do funcion√°rio (opcional)
                    </small>
                </div>
                
                <div class="form-group" id="loginGroup">
                    <label for="userLogin">Login:</label>
                    <input type="text" id="userLogin" required>
                </div>
                
                <div class="form-group" id="passwordGroup">
                    <label for="userPassword">Senha:</label>
                    <input type="password" id="userPassword" autocomplete="new-password">
                    <small id="passwordHelp" style="color: #6b7280; font-size: 0.8rem;">
                        Deixe em branco para manter a senha atual
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="userType">Tipo:</label>
                    <select id="userType" onchange="toggleUserFields()">
                        <option value="funcionario">Funcion√°rio</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                
                <div class="form-group" id="pinGroup" style="display: none;">
                    <label for="userPin">PIN (4 d√≠gitos):</label>
                    <input type="password" id="userPin" maxlength="4" placeholder="1234" autocomplete="new-password">
                    <small style="color: #6b7280; font-size: 0.8rem;">
                        PIN de 4 d√≠gitos para o funcion√°rio bater ponto
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="userDepartamento">Departamento:</label>
                    <select id="userDepartamento">
                        <option value="">Selecione um departamento</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="userGrupoJornada">Grupo de Jornada:</label>
                    <select id="userGrupoJornada">
                        <option value="">Selecione um grupo de jornada</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="userCarga">Carga Hor√°ria Di√°ria:</label>
                    <input type="time" id="userCarga" value="08:00">
                    <small style="color: #6b7280; font-size: 0.8rem;">
                        Ser√° preenchido automaticamente se selecionar um grupo de jornada
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="userTolerancia">Toler√¢ncia (minutos):</label>
                    <input type="number" id="userTolerancia" value="10" min="0" max="60">
                    <small style="color: #6b7280; font-size: 0.8rem;">
                        Ser√° preenchido automaticamente se selecionar um grupo de jornada
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="userAtivo">Status:</label>
                    <select id="userAtivo">
                        <option value="1">Ativo</option>
                        <option value="0">Inativo</option>
                    </select>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModal()">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Departamento -->
    <div id="departamentoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="departamentoModalTitle">Novo Departamento</h4>
                <button class="btn-close" onclick="fecharModalDepartamento()">&times;</button>
            </div>
            
            <form class="modal-form" id="departamentoForm">
                <input type="hidden" id="departamentoId">
                
                <div class="form-group">
                    <label for="departamentoNome">Nome:</label>
                    <input type="text" id="departamentoNome" required>
                </div>
                
                <div class="form-group">
                    <label for="departamentoCodigo">C√≥digo:</label>
                    <input type="text" id="departamentoCodigo" required maxlength="20">
                </div>
                
                <div class="form-group">
                    <label for="departamentoDescricao">Descri√ß√£o:</label>
                    <textarea id="departamentoDescricao" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="departamentoAtivo" checked>
                        Ativo
                    </label>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalDepartamento()">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Jornada -->
    <div id="jornadaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4 id="jornadaModalTitle">Nova Jornada</h4>
                <button class="btn-close" onclick="fecharModalJornada()">&times;</button>
            </div>
            
            <form class="modal-form" id="jornadaForm">
                <input type="hidden" id="jornadaId">
                
                <div class="form-group">
                    <label for="jornadaNome">Nome:</label>
                    <input type="text" id="jornadaNome" required>
                </div>
                
                <div class="form-group">
                    <label for="jornadaCodigo">C√≥digo:</label>
                    <input type="text" id="jornadaCodigo" required maxlength="20">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="jornadaEntrada">Entrada Manh√£:</label>
                        <input type="time" id="jornadaEntrada" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="jornadaSaidaAlmoco">Sa√≠da Almo√ßo:</label>
                        <input type="time" id="jornadaSaidaAlmoco" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="jornadaVoltaAlmoco">Volta Almo√ßo:</label>
                        <input type="time" id="jornadaVoltaAlmoco" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="jornadaSaidaTarde">Sa√≠da Tarde:</label>
                        <input type="time" id="jornadaSaidaTarde" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="jornadaCarga">Carga Di√°ria (min):</label>
                        <input type="number" id="jornadaCarga" required min="60" max="1440">
                    </div>
                    
                    <div class="form-group">
                        <label for="jornadaTolerancia">Toler√¢ncia (min):</label>
                        <input type="number" id="jornadaTolerancia" required min="0" max="60">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="jornadaIntervaloAlmoco">Tempo de Intervalo para Almo√ßo (min):</label>
                    <input type="number" id="jornadaIntervaloAlmoco" min="0" max="180" value="60">
                    <small style="color: #6b7280; font-size: 0.8rem;">
                        Tempo m√≠nimo de almo√ßo (padr√£o: 60 minutos)
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="jornadaVigencia">Data de Vig√™ncia:</label>
                    <input type="date" id="jornadaVigencia">
                </div>
                
                <!-- Configura√ß√µes de S√°bado e Domingo -->
                <div class="form-group">
                    <h4 style="margin-bottom: 15px; color: #2c3e50; border-bottom: 1px solid #ecf0f1; padding-bottom: 5px;">
                        <i class="fas fa-calendar-week"></i> Configura√ß√£o Semanal
                    </h4>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="jornadaSabadoAtivo">
                        <i class="fas fa-calendar-day"></i> Ativar S√°bado (Meio Per√≠odo)
                    </label>
                    <small style="color: #6b7280; font-size: 0.8rem; display: block; margin-top: 5px;">
                        Marque para configurar o s√°bado como dia de trabalho (meio per√≠odo)
                    </small>
                </div>
                
                <div id="sabadoConfig" style="display: none; margin-left: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; border-left: 4px solid #3498db;">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="jornadaEntradaSabado">Entrada S√°bado:</label>
                            <input type="time" id="jornadaEntradaSabado" value="08:00">
                        </div>
                        
                        <div class="form-group">
                            <label for="jornadaSaidaSabado">Sa√≠da S√°bado:</label>
                            <input type="time" id="jornadaSaidaSabado" value="12:00">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="jornadaCargaSabado">Carga S√°bado (min):</label>
                        <input type="number" id="jornadaCargaSabado" value="240" min="60" max="480" readonly>
                        <small style="color: #6b7280; font-size: 0.8rem;">
                            Valor calculado automaticamente (padr√£o: 240 min = 4h)
                        </small>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="jornadaDomingoFolga" checked>
                        <i class="fas fa-calendar-times"></i> Domingo Folga
                    </label>
                    <small style="color: #6b7280; font-size: 0.8rem; display: block; margin-top: 5px;">
                        Quando marcado, domingo n√£o contabiliza faltas/extras
                    </small>
                </div>
                
                <!-- Preview da Carga Hor√°ria -->
                <div class="form-group">
                    <div class="preview-carga">
                        <h4>Preview da Jornada:</h4>
                        <div class="preview-info">
                            <div class="preview-item">
                                <span class="preview-label">Carga Di√°ria (Seg‚ÄìSex):</span>
                                <span class="preview-value" id="previewCarga">08:00</span>
                            </div>
                            <div class="preview-item" id="previewSabadoItem" style="display: none;">
                                <span class="preview-label">Carga S√°bado:</span>
                                <span class="preview-value" id="previewCargaSabado">04:00</span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-label">Domingo:</span>
                                <span class="preview-value" id="previewDomingo">Folga</span>
                            </div>
                            <div class="preview-item" style="border-top: 1px solid #ecf0f1; padding-top: 8px; margin-top: 8px;">
                                <span class="preview-label"><strong>Carga Semanal Total:</strong></span>
                                <span class="preview-value" id="previewCargaSemanal" style="font-weight: bold; color: #27ae60;">44:00</span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-label">Tempo de Almo√ßo:</span>
                                <span class="preview-value" id="previewAlmoco">01:00</span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-label">Intervalo M√≠nimo:</span>
                                <span class="preview-value" id="previewIntervalo">01:00</span>
                            </div>
                            <div class="preview-item">
                                <span class="preview-label">Tempo Total:</span>
                                <span class="preview-value" id="previewTotal">09:00</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="jornadaAtivo" checked>
                        Ativo
                    </label>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalJornada()">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Inserir Registro -->
    <div id="inserirRegistroModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Inserir Registro de Ponto</h4>
                <button class="btn-close" onclick="fecharModalInserirRegistro()">&times;</button>
            </div>
            
            <form class="modal-form" id="inserirRegistroForm">
                <div class="form-group">
                    <label for="inserirFuncionario">Funcion√°rio:</label>
                    <select id="inserirFuncionario" required>
                        <option value="">Selecione um funcion√°rio</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="inserirData">Data:</label>
                    <input type="date" id="inserirData" required>
                </div>
                
                <div class="form-group">
                    <label for="inserirTipo">Tipo de Registro:</label>
                    <select id="inserirTipo" required>
                        <option value="">Selecione o tipo</option>
                        <option value="entrada">Entrada (Manh√£)</option>
                        <option value="almoco_saida">Sa√≠da (Almo√ßo)</option>
                        <option value="almoco_volta">Volta (Almo√ßo)</option>
                        <option value="saida">Sa√≠da (Final)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="inserirHora">Hora:</label>
                    <input type="time" id="inserirHora" step="1" required>
                </div>
                
                <div class="form-group">
                    <label for="inserirObservacao">Observa√ß√£o:</label>
                    <textarea id="inserirObservacao" rows="3" placeholder="Motivo da inser√ß√£o manual..."></textarea>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalInserirRegistro()">Cancelar</button>
                    <button type="submit" class="btn-primary">Inserir Registro</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Editar Registro -->
    <div id="editarRegistroModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Editar Registro de Ponto</h4>
                <button class="btn-close" onclick="fecharModalEditarRegistro()">&times;</button>
            </div>
            
            <form class="modal-form" id="editarRegistroForm">
                <input type="hidden" id="editarRegistroId">
                
                <div class="form-group">
                    <label>Funcion√°rio:</label>
                    <input type="text" id="editarFuncionarioNome" readonly style="background-color: #f3f4f6;">
                </div>
                
                <div class="form-group">
                    <label>Data:</label>
                    <input type="text" id="editarData" readonly style="background-color: #f3f4f6;">
                </div>
                
                <div class="form-group">
                    <label>Tipo:</label>
                    <input type="text" id="editarTipo" readonly style="background-color: #f3f4f6;">
                </div>
                
                <div class="form-group">
                    <label for="editarHora">Nova Hora:</label>
                    <input type="time" id="editarHora" step="1" required>
                    <small style="color: #6b7280; font-size: 0.8rem;">
                        Hora atual: <span id="horaAtual"></span>
                    </small>
                </div>
                
                <div class="form-group">
                    <label for="editarObservacao">Observa√ß√£o:</label>
                    <textarea id="editarObservacao" rows="2" placeholder="Observa√ß√£o adicional..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="editarJustificativa">Justificativa da Edi√ß√£o:</label>
                    <textarea id="editarJustificativa" rows="3" required placeholder="Descreva o motivo da edi√ß√£o..."></textarea>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalEditarRegistro()">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar Altera√ß√µes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Ajuste de Registro -->
    <div id="ajusteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Ajustar Registro de Ponto</h4>
                <button class="btn-close" onclick="fecharModalAjuste()">&times;</button>
            </div>
            
            <form id="ajusteForm" class="modal-form">
                <input type="hidden" id="ajusteRegistroId">
                <input type="hidden" id="ajusteTipo">
                <input type="hidden" id="ajusteData">
                
                <div class="form-group">
                    <label>Funcion√°rio:</label>
                    <div id="ajusteFuncionario" class="info-display"></div>
                </div>
                
                <div class="form-group">
                    <label>Data:</label>
                    <div id="ajusteDataDisplay" class="info-display"></div>
                </div>
                
                <div class="form-group">
                    <label>Hor√°rio Atual:</label>
                    <div id="ajusteHorarioAtual" class="info-display"></div>
                </div>
                
                <div class="form-group">
                    <label for="ajusteNovaHora">Novo Hor√°rio:</label>
                    <input type="time" id="ajusteNovaHora" required step="1">
                </div>
                
                <div class="form-group">
                    <label for="ajusteMotivo">Motivo do Ajuste:</label>
                    <select id="ajusteMotivo" required>
                        <option value="">Selecione o motivo</option>
                        <option value="esquecimento">Esquecimento</option>
                        <option value="erro">Erro de registro</option>
                        <option value="problema_tecnico">Problema t√©cnico</option>
                        <option value="justificativa_admin">Justificativa administrativa</option>
                        <option value="outros">Outros</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="ajusteObservacao">Observa√ß√µes:</label>
                    <textarea id="ajusteObservacao" rows="3" placeholder="Descreva detalhes do ajuste..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="ajusteJustificativa">Justificativa Detalhada:</label>
                    <textarea id="ajusteJustificativa" rows="3" required placeholder="Explique o motivo do ajuste..."></textarea>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalAjuste()">Cancelar</button>
                    <button type="submit" class="btn-primary">Confirmar Ajuste</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Nova Justificativa -->
    <div id="novaJustificativaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Nova Justificativa</h3>
                <button class="modal-close" onclick="fecharModalNovaJustificativa()">&times;</button>
            </div>
            <form id="novaJustificativaForm" onsubmit="criarJustificativa(event)">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="funcionarioJustificativa">Funcion√°rio *</label>
                            <select id="funcionarioJustificativa" required>
                                <option value="">Selecione um funcion√°rio</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tipoJustificativa">Tipo de Justificativa *</label>
                            <select id="tipoJustificativa" required onchange="atualizarCamposTipo()">
                                <option value="">Selecione o tipo</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="dataInicioJustificativa">Data In√≠cio *</label>
                            <input type="date" id="dataInicioJustificativa" required onchange="validarDatasJustificativa()">
                        </div>
                        <div class="form-group">
                            <label for="dataFimJustificativa">Data Fim</label>
                            <input type="date" id="dataFimJustificativa" onchange="validarDatasJustificativa()">
                            <small>Deixe em branco para per√≠odo de um dia. Se igual √† data in√≠cio, ser√° tratado como um dia s√≥.</small>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="periodoJustificativa">Per√≠odo</label>
                        <select id="periodoJustificativa" onchange="atualizarCamposTipo()">
                            <option value="integral">Per√≠odo Integral</option>
                            <option value="manha">Manh√£</option>
                            <option value="tarde">Tarde</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="motivoJustificativa">Motivo *</label>
                        <textarea id="motivoJustificativa" rows="3" required placeholder="Descreva o motivo da justificativa..."></textarea>
                    </div>
                    
                    <div id="infoTipoJustificativa" class="info-box" style="display: none;">
                        <i class="fas fa-info-circle"></i>
                        <span id="textoInfoTipo"></span>
                    </div>
                    
                    <div id="conflitosJustificativa" class="warning-box" style="display: none;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Conflitos detectados:</strong>
                            <ul id="listaConflitos"></ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="fecharModalNovaJustificativa()">Cancelar</button>
                    <button type="submit" class="btn-primary">Criar Justificativa</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Editar Justificativa -->
    <div id="editarJustificativaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Justificativa</h3>
                <button class="modal-close" onclick="fecharModalEditarJustificativa()">&times;</button>
            </div>
            <form id="editarJustificativaForm" onsubmit="editarJustificativa(event)">
                <input type="hidden" id="editarJustificativaId">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editarFuncionarioJustificativa">Funcion√°rio *</label>
                            <select id="editarFuncionarioJustificativa" required>
                                <option value="">Selecione um funcion√°rio</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editarTipoJustificativa">Tipo de Justificativa *</label>
                            <select id="editarTipoJustificativa" required onchange="atualizarCamposTipoEdicao()">
                                <option value="">Selecione o tipo</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="editarDataInicioJustificativa">Data In√≠cio *</label>
                            <input type="date" id="editarDataInicioJustificativa" required onchange="validarDatasJustificativaEdicao()">
                        </div>
                        <div class="form-group">
                            <label for="editarDataFimJustificativa">Data Fim</label>
                            <input type="date" id="editarDataFimJustificativa" onchange="validarDatasJustificativaEdicao()">
                            <small>Deixe em branco para per√≠odo de um dia. Se igual √† data in√≠cio, ser√° tratado como um dia s√≥.</small>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="editarPeriodoJustificativa">Per√≠odo</label>
                        <select id="editarPeriodoJustificativa" onchange="atualizarCamposTipoEdicao()">
                            <option value="integral">Per√≠odo Integral</option>
                            <option value="manha">Manh√£</option>
                            <option value="tarde">Tarde</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="editarMotivoJustificativa">Motivo *</label>
                        <textarea id="editarMotivoJustificativa" rows="3" required placeholder="Descreva o motivo da justificativa..."></textarea>
                    </div>
                    
                    <div id="editarInfoTipoJustificativa" class="info-box" style="display: none;">
                        <i class="fas fa-info-circle"></i>
                        <span id="editarTextoInfoTipo"></span>
                    </div>
                    
                    <div id="editarConflitosJustificativa" class="warning-box" style="display: none;">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Conflitos detectados:</strong>
                            <ul id="editarListaConflitos"></ul>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="fecharModalEditarJustificativa()">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar Altera√ß√µes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Detalhes Justificativa -->
    <div id="detalhesJustificativaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Detalhes da Justificativa</h3>
                <button class="modal-close" onclick="fecharModalDetalhesJustificativa()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="detalhesJustificativaContent">
                    <!-- Conte√∫do ser√° carregado dinamicamente -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="fecharModalDetalhesJustificativa()">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal AFD -->
    <div id="afdModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Gerar AFD - Arquivo Fonte de Dados</h4>
                <button class="btn-close" onclick="fecharModalAFD()">&times;</button>
            </div>
            
            <form class="modal-form" id="afdForm">
                <div class="form-group">
                    <label for="afdDataInicio">Data In√≠cio:</label>
                    <input type="date" id="afdDataInicio" required>
                </div>
                
                <div class="form-group">
                    <label for="afdDataFim">Data Fim:</label>
                    <input type="date" id="afdDataFim" required>
                </div>
                
                <div class="form-group">
                    <label for="afdFuncionario">Funcion√°rio:</label>
                    <select id="afdFuncionario">
                        <option value="">Todos os funcion√°rios</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="afdNomeArquivo">Nome do Arquivo:</label>
                    <input type="text" id="afdNomeArquivo" placeholder="Deixe em branco para nome autom√°tico">
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalAFD()">Cancelar</button>
                    <button type="submit" class="btn-primary">Gerar AFD</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal AEJ -->
    <div id="aejModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Gerar AEJ - Arquivo Eletr√¥nico de Jornada</h4>
                <button class="btn-close" onclick="fecharModalAEJ()">&times;</button>
            </div>
            
            <form class="modal-form" id="aejForm">
                <div class="form-group">
                    <label for="aejDataInicio">Data In√≠cio:</label>
                    <input type="date" id="aejDataInicio" required>
                </div>
                
                <div class="form-group">
                    <label for="aejDataFim">Data Fim:</label>
                    <input type="date" id="aejDataFim" required>
                </div>
                
                <div class="form-group">
                    <label for="aejFuncionario">Funcion√°rio:</label>
                    <select id="aejFuncionario">
                        <option value="">Todos os funcion√°rios</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="aejNomeArquivo">Nome do Arquivo:</label>
                    <input type="text" id="aejNomeArquivo" placeholder="Deixe em branco para nome autom√°tico">
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalAEJ()">Cancelar</button>
                    <button type="submit" class="btn-primary">Gerar AEJ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Espelho Eletr√¥nico -->
    <div id="espelhoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Gerar Espelho Eletr√¥nico de Ponto</h4>
                <button class="btn-close" onclick="fecharModalEspelho()">&times;</button>
            </div>
            
            <form class="modal-form" id="espelhoForm">
                <div class="form-group">
                    <label for="espelhoFuncionario">Funcion√°rio:</label>
                    <select id="espelhoFuncionario" required>
                        <option value="">Selecione um funcion√°rio</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="espelhoDataInicio">Data In√≠cio:</label>
                    <input type="date" id="espelhoDataInicio" required>
                </div>
                
                <div class="form-group">
                    <label for="espelhoDataFim">Data Fim:</label>
                    <input type="date" id="espelhoDataFim" required>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalEspelho()">Cancelar</button>
                    <button type="submit" class="btn-primary">Gerar Espelho</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Compacta√ß√£o -->
    <div id="compactacaoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Compactar Arquivos para DET</h4>
                <button class="btn-close" onclick="fecharModalCompactacao()">&times;</button>
            </div>
            
            <form class="modal-form" id="compactacaoForm">
                <div class="form-group">
                    <label for="compactacaoNome">Nome do Arquivo ZIP:</label>
                    <input type="text" id="compactacaoNome" placeholder="arquivos_det" required>
                </div>
                
                <div class="form-group">
                    <label>Arquivos para Compactar:</label>
                    <div id="arquivosSelecionados" style="border: 1px solid #ddd; padding: 10px; min-height: 100px; background: #f9f9f9;">
                        <p style="color: #666; text-align: center;">Nenhum arquivo selecionado</p>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalCompactacao()">Cancelar</button>
                    <button type="submit" class="btn-primary">Compactar Arquivos</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Backups -->
    <div id="backupsModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h4>
                    <i class="fas fa-database"></i>
                    Gerenciar Backups
                </h4>
                <button class="btn-close" onclick="fecharModalBackups()">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="backups-actions" style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="criarBackupManual()">
                        <i class="fas fa-plus"></i>
                        Criar Backup Manual
                    </button>
                    <button class="btn btn-outline-secondary" onclick="carregarListaBackups()">
                        <i class="fas fa-refresh"></i>
                        Atualizar Lista
                    </button>
                </div>
                
                <div id="backups-list" class="backups-list">
                    <div class="loading" style="text-align: center; padding: 40px; color: #6c757d;">
                        <i class="fas fa-spinner fa-spin"></i>
                        Carregando backups...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Confirma√ß√£o de Atualiza√ß√£o -->
    <div id="updateConfirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h4>
                    <i class="fas fa-exclamation-triangle"></i>
                    Confirmar Atualiza√ß√£o
                </h4>
                <button class="btn-close" onclick="fecharModalConfirmacaoAtualizacao()">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="alert alert-warning" style="background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>Aten√ß√£o!</strong> Esta opera√ß√£o ir√°:
                    <ul style="margin: 10px 0 0 20px;">
                        <li>Criar um backup autom√°tico do sistema</li>
                        <li>Baixar e instalar a nova vers√£o</li>
                        <li>Executar migra√ß√µes de banco de dados</li>
                        <li>Reiniciar o sistema</li>
                    </ul>
                </div>
                
                <div id="update-confirm-info">
                    <!-- Informa√ß√µes da atualiza√ß√£o ser√£o preenchidas aqui -->
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn-secondary" onclick="fecharModalConfirmacaoAtualizacao()">Cancelar</button>
                <button type="button" class="btn-primary" onclick="confirmarInstalacaoAtualizacao()">
                    <i class="fas fa-download"></i>
                    Instalar Atualiza√ß√£o
                </button>
            </div>
        </div>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/time-calculator.js"></script>
    <script src="js/registros-ponto.js"></script>
    <script src="js/compliance.js"></script>
    <script src="js/justificativas.js"></script>
    <script src="js/update-manager.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>